# ç‰ˆæœ¬é…ç½®ç”Ÿäº§ç¯å¢ƒä¿®å¤æŠ¥å‘Š

## é—®é¢˜æè¿°
åœ¨ç”Ÿäº§ç¯å¢ƒæ‰“åŒ…åï¼Œ`getVersionConfig()` å‡½æ•°è·å¾—çš„é…ç½®ä¸ºç©ºï¼Œå¯¼è‡´ç‰ˆæœ¬ç®¡ç†åŠŸèƒ½ä¸æ­£å¸¸ã€‚

## æ ¹æœ¬åŸå› 
1. **æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…é—®é¢˜**ï¼š`prepare-build.cjs` ä¸­çš„æ­£åˆ™è¡¨è¾¾å¼ `/'__BUILD_TIME__': '[^']*'/` æ— æ³•åŒ¹é… `JSON.stringify()` ç”Ÿæˆçš„æ ¼å¼
2. **å…¨å±€å¸¸é‡æ›¿æ¢å¤±è´¥**ï¼šVite çš„ `define` æ’ä»¶æ²¡æœ‰æ­£ç¡®æ›¿æ¢å…¨å±€å¸¸é‡
3. **é”™è¯¯å¤„ç†ä¸å®Œå–„**ï¼šç‰ˆæœ¬é…ç½®å‡½æ•°ç¼ºå°‘ç”Ÿäº§ç¯å¢ƒçš„å…œåº•é€»è¾‘

## è§£å†³æ–¹æ¡ˆ

### 1. ä¿®å¤æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…
**æ–‡ä»¶**: `scripts/prepare-build.cjs`

ä¿®æ”¹å‰:
```javascript
viteConfig = viteConfig.replace(
  /'__BUILD_TIME__': '[^']*'/,
  `'__BUILD_TIME__': ${JSON.stringify(buildTime.toString())}`
);
```

ä¿®æ”¹å:
```javascript
viteConfig = viteConfig.replace(
  /'__BUILD_TIME__':\s*[^,\n]+/,
  `'__BUILD_TIME__': ${JSON.stringify(buildTime.toString())}`
);
```

### 2. å¢å¼ºç‰ˆæœ¬é…ç½®å‡½æ•°
**æ–‡ä»¶**: `src/utils/version.ts`

ä¸»è¦æ”¹è¿›:
- æ›´å¼ºçš„ç±»å‹æ£€æŸ¥å’Œé»˜è®¤å€¼å¤„ç†
- æ·»åŠ è°ƒè¯•ä¿¡æ¯è¾“å‡º
- æ›´å¥½çš„é”™è¯¯å¤„ç†å’Œå…œåº•æœºåˆ¶

### 3. æ·»åŠ ç‰ˆæœ¬ç±»å‹æ”¯æŒ
åœ¨ `scripts/prepare-build.cjs` ä¸­æ·»åŠ äº† `PERMANENT` ç‰ˆæœ¬ç±»å‹æ”¯æŒ

## æµ‹è¯•éªŒè¯

### 1. åŠŸèƒ½æµ‹è¯•
```bash
# æµ‹è¯•è„šæœ¬è‡ªåŠ¨éªŒè¯
node test-version-config.cjs
```

### 2. æ„å»ºæµ‹è¯•
```bash
# å‡†å¤‡æ°¸ä¹…ç‰ˆæœ¬æ„å»º
node scripts/prepare-build.cjs permanent

# æ„å»ºæ¸²æŸ“è¿›ç¨‹
npm run build:renderer

# éªŒè¯å¸¸é‡æ›¿æ¢
findstr /C:"1755433180635" dist/renderer/assets/*.js
findstr /C:"permanent" dist/renderer/assets/*.js
```

### 3. éªŒè¯ç»“æœ
âœ… æ—¶é—´æˆ³æ­£ç¡®æ›¿æ¢åˆ°æ‰“åŒ…æ–‡ä»¶
âœ… ç‰ˆæœ¬ç±»å‹æ­£ç¡®æ›¿æ¢åˆ°æ‰“åŒ…æ–‡ä»¶
âœ… ç‰ˆæœ¬é…ç½®å‡½æ•°åœ¨ç”Ÿäº§ç¯å¢ƒæ­£å¸¸å·¥ä½œ

## æ”¯æŒçš„ç‰ˆæœ¬ç±»å‹

| ç‰ˆæœ¬ç±»å‹ | æ ‡è¯†ç¬¦ | æœ‰æ•ˆæœŸ | ç”¨é€” |
|---------|--------|--------|------|
| è¯•ç”¨ç‰ˆ | `trial` | 3å¤© | çŸ­æœŸè¯•ç”¨ |
| å­£åº¦ç‰ˆ | `quarterly` | 90å¤© | å­£åº¦æˆæƒ |
| æµ‹è¯•ç‰ˆ | `test` | 5åˆ†é’Ÿ | åŠŸèƒ½æµ‹è¯• |
| æ°¸ä¹…ç‰ˆ | `permanent` | æ— é™æœŸ | æ°¸ä¹…æˆæƒ |

## ä½¿ç”¨æ–¹æ³•

### æ„å»ºä¸åŒç‰ˆæœ¬
```bash
# æ„å»ºè¯•ç”¨ç‰ˆ
npm run build:trial

# æ„å»ºå­£åº¦ç‰ˆ
npm run build:quarterly

# æ„å»ºæµ‹è¯•ç‰ˆ
npm run build:test

# æ„å»ºæ°¸ä¹…ç‰ˆ
npm run build:permanent

# æ„å»ºæ‰€æœ‰ç‰ˆæœ¬
npm run build:all
```

### å¼€å‘ç¯å¢ƒ
- é»˜è®¤ä½¿ç”¨æ°¸ä¹…ç‰ˆæœ¬
- æ”¯æŒçƒ­é‡è½½
- åŒ…å«è°ƒè¯•ä¿¡æ¯

### ç”Ÿäº§ç¯å¢ƒ
- æ ¹æ®æ„å»ºç±»å‹è®¾ç½®ç‰ˆæœ¬
- å…¨å±€å¸¸é‡è¢«æ­£ç¡®æ›¿æ¢
- ç‰ˆæœ¬ä¿¡æ¯æ­£ç¡®æ˜¾ç¤º

## ä¿®å¤çŠ¶æ€
ğŸ‰ **é—®é¢˜å·²å®Œå…¨è§£å†³**

- âœ… ç”Ÿäº§ç¯å¢ƒç‰ˆæœ¬é…ç½®æ­£å¸¸å·¥ä½œ
- âœ… æ‰€æœ‰ç‰ˆæœ¬ç±»å‹æ”¯æŒå®Œæ•´
- âœ… æ„å»ºè„šæœ¬ä¿®å¤å®Œæˆ
- âœ… è‡ªåŠ¨åŒ–æµ‹è¯•é€šè¿‡
